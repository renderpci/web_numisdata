{"version":3,"sources":["biblio.js"],"names":["biblio","set_up","options","form","document","getElementById","ar_form_inputs","querySelectorAll","ar_form_inputs_len","length","i","this","activate_autocomplete","search_rows","ar_query","limit","biblio_section_id","current_obj","name","value","search_mode","table","push","set_value","object","container","id","inputs","line","common","create_dom_element","element_type","class_name","parent","addEventListener","parentNode","remove","data_set","dataset","element","self","cache","$","autocomplete","delay","minLength","source","request","response","term","trigger_url","page_globals","__WEB_TEMPLATE_WEB__","trigger_vars","q","mode","q_name","q_table","SHOW_DEBUG","console","log","get_json_data","then","response_data","result","map","item","label","substring","error","select","event","ui","preventDefault","focus","close","change","on","keyCode","ENTER","style","opacity","draw_rows","target","ar_rows","warn","search","form_obj","ar_input_len","input","hasChildNodes","removeChild","lastChild","collator","Intl","Collator","sensitivity","ignorePunctuation","sort","a","b","order_a","autoria","fecha_publicacion","order_b","compare","ar_rows_length","biblio_object","biblio_row_wrapper","section_id","row_title","autoria_dato","autoria_length","ar_final_autoria","j","autor_text","apellidos","nombre","final_autoria","join","text_content","ar_fecha","split","fecha_final","parseInt","_typeof","row_body","titulo","series_colecciones","numero_serie","series_info","lugar_publicacion","description_fisica","coma"],"mappings":"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","sourcesContent":["\"use strict\";\n\n\n\nvar biblio =  {\n\n\n\tset_up : function(options) {\n\n\t\tvar self = this\n\n\t\t//console.log(\"biblio_options:\",options); return\t\t\n\n\t\tconst form = document.getElementById(\"search_form\")\n\t\tif (form) {\n\t\t\tconst ar_form_inputs  \t = form.querySelectorAll(\"input.form-control\")\n\t\t\tconst ar_form_inputs_len = ar_form_inputs.length\t\t\n\t\t\tfor (var i = 0; i < ar_form_inputs_len; i++) {\t\t\n\t\t\n\t\t\t\t// Activate autocomplete behabiour for each input\n\t\t\t\tself.activate_autocomplete(ar_form_inputs[i])\n\n\t\t\t\t// Add event keyup to all inputs\n\t\t\t\t//ar_form_inputs[i].addEventListener(\"keyup\", function(e){\n\t\t\t\t//\t//self.search(form, null)\n\t\t\t\t//},false)\t\t\t\n\t\t\t}\n\n\t\t\t// exec first default search without params\n\t\t\t\tself.search_rows({\n\t\t\t\t\tar_query : [],\n\t\t\t\t\tlimit \t : 100\n\t\t\t\t}) // First search\n\n\t\t}else if (typeof biblio_section_id!==\"undefined\") {\n\n\t\t\t// Defined in html file\t\n\t\t\t\tvar ar_query \t= []\n\t\t\t\tvar current_obj = {\n\t\t\t\t\t\tname \t\t: \"section_id\", // input.name,\n\t\t\t\t\t\tvalue \t\t: biblio_section_id,\n\t\t\t\t\t\tsearch_mode : \"string\",\n\t\t\t\t\t\ttable \t\t: \"publicaciones\"\n\t\t\t\t\t}\n\t\t\t\t\tar_query.push(current_obj)\n\n\t\t\t\tself.search_rows({\n\t\t\t\t\tar_query : ar_query\n\t\t\t\t})\n\n\t\t}\n\t\t\n\n\t\treturn true\n\t},//end set_up\n\n\n\n\t/**\n\t* SET_VALUE\n\t*/\n\tset_value : function(object, value) {\n\t\t//console.log(\"object:\",object);\n\t\tconst container = document.getElementById(object.id + \"_values\")\n\n\t\t// Check if already exists \n\t\t\tconst inputs \t\t= container.querySelectorAll(\".input_values\")\n\t\t\tconst inputs_length = inputs.length\n\t\t\tfor (var i = inputs_length - 1; i >= 0; i--) {\n\t\t\t\tif (value===inputs[i].value) return false;\n\t\t\t}\n\n\t\t// Create new line \n\t\t\tconst line = common.create_dom_element({\n\t\t\t\telement_type \t: \"div\",\n\t\t\t\tclass_name   \t: \"line_value\",\n\t\t\t\tparent \t\t\t: container\n\t\t\t\t})\n\t\t\t\t// <i class=\"fal fa-trash-alt\"></i>\n\t\t\t\tvar trash = common.create_dom_element({\n\t\t\t\t\telement_type \t: \"i\",\n\t\t\t\t\t//class_name   \t: \"far fa-trash-alt\", // awesome font 5\n\t\t\t\t\tclass_name   \t: \"icon fa-trash\", //awesome font 4\n\t\t\t\t\tparent \t\t\t: line\n\t\t\t\t\t})\n\t\t\t\t\ttrash.addEventListener(\"click\",function(){\n\t\t\t\t\t\tthis.parentNode.remove()\n\t\t\t\t\t})\n\t\t\t\tvar input = common.create_dom_element({\n\t\t\t\t\telement_type \t: \"input\",\n\t\t\t\t\tclass_name   \t: \"input_values\",\n\t\t\t\t\tparent \t\t\t: line,\n\t\t\t\t\tdata_set \t\t: object.dataset // Inherit dataset\n\t\t\t\t})\n\t\t\t\tinput.value = value\n\n\t\treturn true\n\t},//end set_value\n\n\n\n\t/**\n\t* ACTIVATE_AUTOCOMPLETE\n\t*/\n\tactivate_autocomplete : function(element) {\n\t\n\t\tconst self = this\n\n\t\tvar cache = {};\n\t\t$(element).autocomplete({\n\t\t\tdelay \t : 150,\n\t\t\tminLength: 1,\n\t\t\tsource \t : function( request, response ) {\n\t\t\t\t\n\t\t\t\tvar term  = request.term;\n\n\t\t\t\t// Cache\t\t\t\t\n\t\t\t\tif ( term in cache ) {\n\t\t\t\t  response( cache[ term ] );\n\t\t\t\t  return;\n\t\t\t\t}\n\n\t\t\t\tconst trigger_url  = page_globals.__WEB_TEMPLATE_WEB__ + \"/tpl_common/trigger.tpl_common.php\"\n\t\t\t\tconst trigger_vars = {\n\t\t\t\t\t\tq\t\t: term,\n\t\t\t\t\t\tmode\t: element.dataset.mode,\n\t\t\t\t\t\tq_name  : element.dataset.q_name || null,\n\t\t\t\t\t\tq_table : element.dataset.q_table || null\n\t\t\t\t}\n\t\t\t\tif(SHOW_DEBUG===true) {\n\t\t\t\t\tconsole.log(\"trigger_vars:\",trigger_vars);\n\t\t\t\t}\t\t\t\t\n\n\t\t\t\tcommon.get_json_data(trigger_url, trigger_vars).then(function(response_data) {\n\t\t\t\t\t\tif(SHOW_DEBUG===true) {\n\t\t\t\t\t\t\tconsole.log(\"[activate_autocomplete] response_data\",response_data)\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (element.id===\"fecha_publicacion\") {\n\t\t\t\t\t\t\tconst result = response_data.result.map( item => {\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\titem.label = item.label.substring(0, 4)\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\treturn item\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\tconsole.log(\"result:\",result);\n\t\t\t\t\t\t\tresponse(result)\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tresponse(response_data.result)\n\t\t\t\t\t\t}\t\t\t\t\t\t\n\n\t\t\t\t}, function(error) {\n\t\t\t\t\t\tconsole.error(\"[activate_autocomplete] Failed get_json!\", error);\n\t\t\t\t});\t\t\t\t\n\t\t\t},\n\t\t\t// When a option is selected in list\n\t\t\tselect: function( event, ui ) {\n\t\t\t\t// prevent set selected value to autocomplete input\n\t\t\t\tevent.preventDefault();\n\n\t\t\t\t/* MULTI \n\t\t\t\t  var terms = split( this.value );\n\t\t          // remove the current input\n\t\t          terms.pop();\n\t\t          // add the selected item\n\t\t          terms.push( ui.item.label );\n\t\t          // add placeholder to get the comma-and-space at the end\n\t\t          terms.push( \"\" );\n\t\t          this.value = terms.join( \", \" );\n\t\t          return false; */\t\t\t\t\t\t\n\t\t\t\tself.set_value(this, ui.item.label)\n\t\t\t\tthis.value = ''\n\t\t\t\t//this.value = ui.item.label\n\n\t\t\t\t//$(this).blur()\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\t// When a option is focus in list\n\t\t\tfocus: function() {\n\t          // prevent value inserted on focus\n\t          return false;\n\t        },\n\t        close: function( event, ui ) {\n\t        \t\n\t        },        \n\t\t\tchange: function( event, ui ) {\t\t\t\t\n\n\t\t\t},\n\t\t\tresponse: function( event, ui ) {\n\t\t\t\t//console.log(ui);\n\t\t\t}\t\t\t\n\t\t})\n\t\t.on( \"keydown\", function( event ) {\n\t\t\t//return false\n\t\t\t//console.log(event)\n\t\t\tif ( event.keyCode === $.ui.keyCode.ENTER  ) {\n\t\t\t\t// prevent set selected value to autocomplete input\n\t\t\t\t//event.preventDefault();\n\t\t\t\t//var term = $(this).val();\n\t\t\t\t\t\n\t\t\t}//end if ( event.keyCode === $.ui.keyCode.ENTER  )\n\t\t});// bind\n\n\t\treturn true\n\t},//end activate_autocomplete\n\t\n\n\n\t/**\n\t* SEARCH_ROWS\n\t* Call to trigger and load json data results of search. On complete load, draw list items\n\t*/\n\tsearch_rows : function(options) {\n\t\n\t\tconst trigger_url  = page_globals.__WEB_TEMPLATE_WEB__ + \"/biblio/trigger.biblio.php\"\n\t\tconst trigger_vars = {\n\t\t\tmode \t : \"search_rows\",\n\t\t\tar_query : typeof(options.ar_query)!==\"undefined\" ? options.ar_query : null,\n\t\t\tlimit \t : options.limit || 10 \n\t\t}\n\t\tif(SHOW_DEBUG===true) {\n\t\t\tconsole.log(\"trigger_vars:\",trigger_vars);\n\t\t}\n\t\t\n\n\t\tconst container = document.getElementById(\"biblio_rows_list\")\n\t\t\tcontainer.style.opacity = \"0.4\"\n\n\t\t// Http request directly in javascript to the API is possible too..\n\t\tconst js_promise = common.get_json_data(trigger_url, trigger_vars).then(function(response){\n\t\t\t\tif(SHOW_DEBUG===true) {\n\t\t\t\t\tconsole.log(\"[biblio.search_rows] response:\" , response);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (!response) {\n\t\t\t\t\t// Error on load data from trigger\n\t\t\t\t\tconsole.warn(\"[common.search_rows] Error. Received response data is null\");\n\t\t\t\t\n\t\t\t\t}else{\n\t\t\t\t\t// Success\n\t\t\t\t\tbiblio.draw_rows({\n\t\t\t\t\t\ttarget  : 'biblio_rows_list',\n\t\t\t\t\t\tar_rows : response.result\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\tcontainer.style.opacity = \"1\"\n\t\t})\n\n\t\treturn js_promise\n\t},//end search_rows\n\n\n\n\t/**\n\t* SEARCH\n\t*/\n\tsearch : function(form_obj, event) {\n\t\tif (event)\n\t\tevent.preventDefault(); // Prevent submit and navigate to url\n\t\t//console.log(\"form_obj:\",form_obj,event);\n\n\t\tvar self = this\n\n\t\tvar ar_query \t\t= []\n\t\tvar ar_form_inputs  = form_obj.querySelectorAll(\"input.input_values, input.form-control\")\n\t\tvar ar_input_len \t= ar_form_inputs.length\t\t\n\t\tfor (var i = 0; i < ar_input_len; i++) {\n\t\t\t\n\t\t\tvar input = ar_form_inputs[i]\n\n\t\t\tif (input.value.length>0) {\n\t\t\t\tvar current_obj = {\n\t\t\t\t\tname \t\t: input.dataset.q_name, // input.name,\n\t\t\t\t\tvalue \t\t: input.value,\n\t\t\t\t\tsearch_mode : input.dataset.search,\n\t\t\t\t\ttable \t\t: input.dataset.q_table\n\t\t\t\t}\n\t\t\t\tar_query.push(current_obj)\n\t\t\t}\n\t\t}\t\t\n\t\tconsole.log(\"ar_query:\",ar_query)\n\n\t\tself.search_rows({\n\t\t\tar_query : ar_query\n\t\t})\n\n\t\treturn true\n\t},//end search\n\n\n\n\t/**\n\t* DRAW_ROWS\n\t*/\n\tdraw_rows : function(options) {\n\t\t\n\t\tconst self = this\n\t\n\t\tconst container = document.getElementById(options.target)\n\t\tconst ar_rows \t= options.ar_rows\t\t\n\t\t\n\t\t// clean container div \n\t\t\twhile (container.hasChildNodes()) {\n\t\t\t\tcontainer.removeChild(container.lastChild);\n\t\t\t}\n\t\n\t\t// order \n\t\t\tlet collator = new Intl.Collator('es',{ sensitivity: 'base', ignorePunctuation:true});\n\t\t\tar_rows.sort( (a,b) => {\n\t\t\t\t\tlet order_a = a.autoria +\" \"+ a.fecha_publicacion\n\t\t\t\t\tlet order_b = b.autoria +\" \"+ b.fecha_publicacion\n\t\t\t\t\t//console.log(\"order_a\",order_a, order_b);\n\t\t\t\t\t//console.log(collator.compare(order_a , order_b));\n\t\t\t\treturn collator.compare(order_a , order_b)\n\t\t\t});\n\n\t\tconst ar_rows_length = ar_rows.length\n\t\tfor (var i = 0; i < ar_rows_length; i++) {\n\n\t\t\t// Build dom row\n\n\t\t\t// item biblio_object\n\t\t\t\tconst biblio_object = ar_rows[i]\n\n\t\t\t// wrapper \n\t\t\t\tconst biblio_row_wrapper = common.create_dom_element({\n\t\t\t\t\t  element_type \t: \"div\",\n\t\t\t\t\t  class_name \t: \"biblio_row_wrapper\",\n\t\t\t\t\t  parent \t\t: container,\n\t\t\t\t\t  data_set \t\t: {\n\t\t\t\t\t  \tsection_id \t: biblio_object.section_id\n\t\t\t\t\t  }\n\t\t\t\t})\n\n\t\t\t// div title \n\t\t\t\tvar row_title = common.create_dom_element({\n\t\t\t\t\telement_type \t: \"div\",\n\t\t\t\t\tparent \t\t\t: biblio_row_wrapper,\n\t\t\t\t\tclass_name \t\t: \"row_title\"\n\t\t\t\t})\n\n\t\t\t// autoria \n\t\t\t\tif (biblio_object.autoria && biblio_object.autoria.length>0) {\n\t\t\t\t\t//console.log(\"biblio_object.autoria:\",biblio_object.autoria);\n\t\t\t\t\t//console.log(\"biblio_object.autoria_dato:\",biblio_object.autoria_dato);\n\n\n\t\t\t\t\tvar autoria \t\t= biblio_object.autoria_dato\n\t\t\t\t\tvar autoria_length \t= autoria.length\n\n\t\t\t\t\tvar ar_final_autoria = []\n\n\t\t\t\t\tfor (var j = 0; j < autoria_length; j++) {\n\t\t\t\t\t\tlet autor_text = autoria[j].apellidos +\", \"+ autoria[j].nombre\n\t\t\t\t\t\tar_final_autoria.push(autor_text)\n\t\t\t\t\t}\n\n\t\t\t\t\tlet final_autoria = ar_final_autoria.join(\"; \")\n\n\t\t\t\t\tvar line = common.create_dom_element({\n\t\t\t\t\t\telement_type \t: \"div\",\n\t\t\t\t\t\tparent \t\t\t: row_title,\n\t\t\t\t\t\tclass_name \t\t: \"autoria info_line\"\n\t\t\t\t\t\t})\n\t\t\t\t\t\t/*common.create_dom_element({\n\t\t\t\t\t\t\telement_type \t: \"div\",\n\t\t\t\t\t\t\tparent \t\t\t: line,\n\t\t\t\t\t\t\tclass_name \t\t: \"info_label\",\n\t\t\t\t\t\t\ttext_content \t: tstring[\"autoria\"]\n\t\t\t\t\t\t})*/\n\t\t\t\t\t\tcommon.create_dom_element({\n\t\t\t\t\t\t\telement_type \t: \"div\",\n\t\t\t\t\t\t\tparent \t\t\t: line,\n\t\t\t\t\t\t\tclass_name \t\t: \"info_value\",\n\t\t\t\t\t\t\ttext_content \t: final_autoria\n\t\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t// fecha_publicacion \n\t\t\t\tif (biblio_object.fecha_publicacion) {\n\n\t\t\t\t\tvar ar_fecha \t= biblio_object.fecha_publicacion.split(\"-\")\n\t\t\t\t\tvar fecha_final = parseInt(ar_fecha[0])\n\n\t\t\t\t\tif( typeof(ar_fecha[1]!==\"undefined\") && parseInt(ar_fecha[1]) > 0 ) {\t\t\t\t\t\n\t\t\t\t\t\tfecha_final = fecha_final + \"-\" + parseInt(ar_fecha[1])\n\t\t\t\t\t}\n\t\t\t\t\tif( typeof(ar_fecha[2]!==\"undefined\") && parseInt(ar_fecha[2]) > 0 ) {\n\t\t\t\t\t\tfecha_final = fecha_final + \"-\" + parseInt(ar_fecha[2])\n\t\t\t\t\t}\n\n\t\t\t\t\tvar line = common.create_dom_element({\n\t\t\t\t\t\telement_type \t: \"div\",\n\t\t\t\t\t\tclass_name \t\t: \"fecha_publicacion info_line\",\n\t\t\t\t\t\tparent \t\t\t: biblio_row_wrapper\n\t\t\t\t\t\t})\n\t\t\t\t\t\tcommon.create_dom_element({\n\t\t\t\t\t\t\telement_type \t: \"div\",\n\t\t\t\t\t\t\tparent \t\t\t: line,\n\t\t\t\t\t\t\tclass_name \t\t: \"info_value\",\n\t\t\t\t\t\t\ttext_content \t: fecha_final\n\t\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t// div body\t\n\t\t\t\tconst row_body = common.create_dom_element({\n\t\t\t\t\telement_type \t: \"div\",\n\t\t\t\t\tparent \t\t\t: biblio_row_wrapper,\n\t\t\t\t\tclass_name \t\t: \"row_body\"\n\t\t\t\t})\n\n\t\t\t\t// title\n\t\t\t\t\tconst titulo = biblio_object.titulo || ''\n\t\t\t\t\tcommon.create_dom_element({\n\t\t\t\t\t\telement_type \t: \"h1\",\n\t\t\t\t\t\tparent \t\t\t: row_body,\n\t\t\t\t\t\ttext_content \t: titulo\n\t\t\t\t\t})\n\n\t\t\t// series_colecciones \n\t\t\t\tif (biblio_object.series_colecciones || biblio_object.numero_serie) {\n\t\t\t\t\tvar series_info = []\n\t\t\t\t\tif (biblio_object.series_colecciones) {\n\t\t\t\t\t\t series_info.push(biblio_object.series_colecciones) \n\t\t\t\t\t}\n\t\t\t\t\tif (biblio_object.numero_serie) {\n\t\t\t\t\t\t series_info.push(biblio_object.numero_serie)\n\t\t\t\t\t}\n\t\t\t\t\tcommon.create_dom_element({\n\t\t\t\t\t\telement_type \t: \"em\",\n\t\t\t\t\t\tparent \t\t\t: row_body,\n\t\t\t\t\t\tclass_name \t\t: \"series_colecciones\",\n\t\t\t\t\t\ttext_content \t: series_info.join(\" \")\n\t\t\t\t\t})\n\t\t\t\t}\t\t\t\n\t\t\t\n\t\t\t// lugar_publicacion \n\t\t\t\tif (biblio_object.lugar_publicacion) {\n\t\t\t\t\tvar line = common.create_dom_element({\n\t\t\t\t\t\telement_type \t: \"div\",\n\t\t\t\t\t\tparent \t\t\t: row_body,\n\t\t\t\t\t\tclass_name \t\t: \"lugar_publicacion info_line\"\n\t\t\t\t\t\t})\n\t\t\t\t\t\t/*common.create_dom_element({\n\t\t\t\t\t\t\telement_type \t: \"div\",\n\t\t\t\t\t\t\tparent \t\t\t: line,\n\t\t\t\t\t\t\tclass_name \t\t: \"info_label\",\n\t\t\t\t\t\t\ttext_content \t: tstring[\"lugar_publicacion\"]\n\t\t\t\t\t\t})*/\n\t\t\t\t\t\tcommon.create_dom_element({\n\t\t\t\t\t\t\telement_type \t: \"div\",\n\t\t\t\t\t\t\tparent \t\t\t: line,\n\t\t\t\t\t\t\tclass_name \t\t: \"info_value\",\n\t\t\t\t\t\t\ttext_content \t: biblio_object.lugar_publicacion\n\t\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t// description_fisica \n\t\t\t\tif (biblio_object.description_fisica) {\n\t\t\t\t\tvar line = common.create_dom_element({\n\t\t\t\t\t\telement_type \t: \"div\",\n\t\t\t\t\t\tparent \t\t\t: row_body,\n\t\t\t\t\t\tclass_name \t\t: \"description_fisica info_line\"\n\t\t\t\t\t\t})\n\t\t\t\t\t\t/*common.create_dom_element({\n\t\t\t\t\t\t\telement_type \t: \"div\",\n\t\t\t\t\t\t\tparent \t\t\t: line,\n\t\t\t\t\t\t\tclass_name \t\t: \"info_label\",\n\t\t\t\t\t\t\ttext_content \t: tstring[\"lugar_publicacion\"]\n\t\t\t\t\t\t})*/\n\n\t\t\t\t\t\tvar coma = \", \"\n\t\t\t\t\t\t\t//console.log(biblio_object.numero_serie ==false)\n\n\t\t\t\t\t\tif (biblio_object.lugar_publicacion ==false ){\n\t\t\t\t\t\t\tcoma = \"\"\n\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\tcommon.create_dom_element({\n\t\t\t\t\t\t\telement_type \t: \"div\",\n\t\t\t\t\t\t\tparent \t\t\t: line,\n\t\t\t\t\t\t\tclass_name \t\t: \"info_value\",\n\t\t\t\t\t\t\ttext_content \t: coma+biblio_object.description_fisica\n\t\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t// notas \n\t\t\t\t/*\n\t\t\t\tif (biblio_object.nota_general) {\n\t\t\t\t\tvar line = common.create_dom_element({\n\t\t\t\t\t\telement_type \t: \"div\",\n\t\t\t\t\t\tparent \t\t\t: row_body,\n\t\t\t\t\t\tclass_name \t\t: \"nota_general\"\n\t\t\t\t\t\t})\n\t\t\t\t\t\tcommon.create_dom_element({\n\t\t\t\t\t\t\telement_type \t: \"div\",\n\t\t\t\t\t\t\tparent \t\t\t: line,\n\t\t\t\t\t\t\tclass_name \t\t: \"info_label\",\n\t\t\t\t\t\t\ttext_content \t: tstring[\"notas\"]\n\t\t\t\t\t\t})\n\t\t\t\t\t\tcommon.create_dom_element({\n\t\t\t\t\t\t\telement_type \t: \"div\",\n\t\t\t\t\t\t\tparent \t\t\t: line,\n\t\t\t\t\t\t\tclass_name \t\t: \"info_value\",\n\t\t\t\t\t\t\ttext_content \t: biblio_object.nota_general\n\t\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\t*/\n\n\t\t\t// codigo \n\t\t\t\t/*if (biblio_object.codigo) {\n\t\t\t\t\tvar line = common.create_dom_element({\n\t\t\t\t\t\telement_type \t: \"div\",\n\t\t\t\t\t\tparent \t\t\t: row_body,\n\t\t\t\t\t\tclass_name \t\t: \"fecha_publicacion info_line\"\n\t\t\t\t\t\t})\n\t\t\t\t\t\tcommon.create_dom_element({\n\t\t\t\t\t\t\telement_type \t: \"div\",\n\t\t\t\t\t\t\tparent \t\t\t: line,\n\t\t\t\t\t\t\tclass_name \t\t: \"info_label\",\n\t\t\t\t\t\t\ttext_content \t: tstring[\"codigo\"]\n\t\t\t\t\t\t})\n\t\t\t\t\t\tcommon.create_dom_element({\n\t\t\t\t\t\t\telement_type \t: \"div\",\n\t\t\t\t\t\t\tparent \t\t\t: line,\n\t\t\t\t\t\t\tclass_name \t\t: \"info_value\",\n\t\t\t\t\t\t\ttext_content \t: biblio_object.codigo\n\t\t\t\t\t\t})\n\t\t\t\t}*/\t\t\t\n\n\t\t}//end for (var i = 0; i < len; i++)\n\n\t\treturn true\n\t},//end draw_rows\n\n\n\n}//end biblio"]}