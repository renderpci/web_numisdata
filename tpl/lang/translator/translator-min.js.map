{"version":3,"sources":["translator.js"],"names":["_data_manager","require","init_translator","options","build_list","main","document","getElementById","base_lang_data","data","base_lang","langs","Object","keys","first","sort","x","y","i","length","input","createElement","type","setAttribute","classList","add","appendChild","label","ar_values","value","lang","push","_i","current_value","node","build_line","line","_loop","dataset","key","addEventListener","e","save_lang_file","target","ar_inputs","querySelectorAll","request","url","body","then","response","remove","result","alert","console","log","setTimeout"],"mappings":"mGAAA,IAAAA,cAAAC,QAAA,qBAOaC,gBAAkB,SAACC,GAK/B,OAFCC,WAAWD,IAEL,2CAQR,IAAMC,WAAa,SAACD,GAEnB,IAAME,EAAOC,SAASC,eAAe,QAE/BC,EAAiBL,EAAQM,KAAKN,EAAQO,WACtCC,EAAWC,OAAOC,KAAKV,EAAQM,MAG/BK,EAAQX,EAAQO,UACtBC,EAAMI,KAAK,SAASC,EAAEC,GAAI,OAAOD,GAAKF,GAAS,EAAIG,GAAKH,EAAQ,EAAI,IAGnE,IAAK,IAAII,EAAI,EAAGA,EAAIP,EAAMQ,OAAQD,IAAK,CAEtC,IAAME,EAAQd,SAASe,cAAc,SACrCD,EAAME,KAAQ,OACdF,EAAMG,aAAa,QAASZ,EAAMO,IAClCE,EAAMG,aAAa,YAAY,GAC/BH,EAAMI,UAAUC,IAAI,UAEpBpB,EAAKqB,YAAYN,GAKlB,IAAI,IAAMO,KAASnB,EAAgB,CAElC,IAAMoB,EAAa,GACbC,EAAU,CACfC,KAAQ3B,EAAQO,UAChBmB,MAAQrB,EAAemB,IAExBC,EAAUG,KAAKF,GAEf,IAAK,IAAIG,EAAI,EAAGA,EAAIrB,EAAMQ,OAAQa,IAAK,CAEtC,IAAMF,EAAOnB,EAAMqB,GACnB,GAAIF,IAAO3B,EAAQO,UAAnB,CAEA,IAAMuB,EAAgB,CACrBH,KAAQA,EACRD,MAAQ1B,EAAQM,KAAKqB,GAAMH,IAAU,MAEtCC,EAAUG,KAAKE,IAEhB,IAAMC,EAAOC,WAAWR,EAAOC,GAI/BvB,EAAKqB,YAAYQ,GAInB,OAAO,GAQFC,WAAa,SAACR,EAAOC,GAUzB,IARD,IAAMQ,EAAO9B,SAASe,cAAc,OAFIgB,EAAA,SAU9BnB,GAER,IAAMW,EAAQD,EAAUV,GAAGW,OAAS,GAC9BC,EAAQF,EAAUV,GAAGY,KAErBV,EAAQd,SAASe,cAAc,SAErCD,EAAME,KAAQ,OACdF,EAAMG,aAAa,QAASM,GAC5BT,EAAMG,aAAa,cAAeI,GAClCP,EAAMG,aAAa,QAASI,GAC5BP,EAAMkB,QAAQC,IAAOZ,EACrBP,EAAMkB,QAAQR,KAAOA,EAErBV,EAAMoB,iBAAiB,SAAU,SAASC,GAEzCC,eAAeD,EAAEE,OAAQb,KAG1BM,EAAKV,YAAYN,IAnBTF,EAAI,EAAGA,EAAIU,EAAUT,OAAQD,IAAKmB,EAAlCnB,GAuBV,OAAOkB,GAQFM,eAAiB,SAACR,EAAMJ,GAK7B,IAHA,IAAMrB,EAAO,GAEPmC,EAAYtC,SAASuC,iBAAiB,oBAAoBf,EAAK,MAC5DZ,EAAI,EAAGA,EAAI0B,EAAUzB,OAAQD,IAAK,CAE1C,IAAMqB,EAAOK,EAAU1B,GAAGoB,QAAQC,IAC5BV,EAAQe,EAAU1B,GAAGW,MAE3BpB,EAAK8B,GAAOV,EAgCb,OA3BA,EAAA7B,cAAA8C,SAAQ,CACPC,IAAO,yBACPC,KAAO,CACNlB,KAAOA,EACPrB,KAAOA,KAGRwC,KAAK,SAACC,GAGNhB,EAAKV,UAAU2B,OAAO,QAAQ,aAE1BD,EAASE,OAAO,GACnBC,MAAM,sBAAwBvB,EAAO,SACrCI,EAAKV,UAAUC,IAAI,eAEnB6B,QAAQC,IAAI,eAAgBL,GAE5BhB,EAAKV,UAAUC,IAAI,UAGpB+B,WAAW,WACVtB,EAAKV,UAAU2B,OAAO,QAAQ,cAC7B,QAII","sourcesContent":["import {request} from './data_manager.js'\n\n\n\n/**\n* INIT_TRANSLATOR\n*/\nexport const init_translator = (options) => {\n\t\n\t// render list\n\t\tbuild_list(options)\n\n\treturn true\n}//end init_translator\n\n\n\n/**\n* build_list\n*/\nconst build_list = (options) => {\n\t\n\tconst main = document.getElementById(\"main\")\n\n\tconst base_lang_data = options.data[options.base_lang]\n\tconst langs \t\t = Object.keys(options.data)\n\n\t// sort langs with base_lang on top\n\tconst first = options.base_lang;\n\tlangs.sort(function(x,y){ return x == first ? -1 : y == first ? 1 : 0; });\t\n\n\t// headers\n\t\tfor (let i = 0; i < langs.length; i++) {\n\n\t\t\tconst input = document.createElement(\"input\")\n\t\t\tinput.type  = \"text\"\n\t\t\tinput.setAttribute('value', langs[i])\n\t\t\tinput.setAttribute('readonly', true)\n\t\t\tinput.classList.add(\"header\")\n\n\t\t\tmain.appendChild(input)\n\t\t}\n\t\n\t\t\n\t// iterate base lang\n\t\tfor(const label in base_lang_data) {\n\n\t\t\tconst ar_values \t= []\t\t\n\t\t\tconst value \t\t= {\n\t\t\t\tlang  : options.base_lang,\n\t\t\t\tvalue : base_lang_data[label]\n\t\t\t}\n\t\t\tar_values.push(value)\n\n\t\t\tfor (let i = 0; i < langs.length; i++) {\n\t\t\t\t\n\t\t\t\tconst lang = langs[i]\n\t\t\t\tif (lang===options.base_lang) continue;\n\n\t\t\t\tconst current_value = {\n\t\t\t\t\tlang  : lang,\n\t\t\t\t\tvalue : options.data[lang][label] || null\n\t\t\t\t} \n\t\t\t\tar_values.push(current_value)\n\t\t\t}\n\t\t\tconst node = build_line(label, ar_values)\n\t\t\t\t//console.log(\"node:\",node);\n\n\n\t\t\tmain.appendChild(node)\n\t\t}\n\t\n\t\n\treturn true\n}//end build_list\n\n\n\n/**\n* BUILD_LINE\n*/\nconst build_line = (label, ar_values) => {\n\t\n\tconst line = document.createElement(\"div\")\n\n\t// label\n\t\t//const \tlabel_node = document.createElement(\"span\")\n\t\t//\t\tlabel_node.innerText = label\n\t\t//\t\tline.appendChild(label_node)\n\n\t// input\n\t\tfor (let i = 0; i < ar_values.length; i++) {\n\t\t\t\n\t\t\tconst value = ar_values[i].value || \"\"\n\t\t\tconst lang \t= ar_values[i].lang\n\n\t\t\tconst input = document.createElement(\"input\")\n\n\t\t\tinput.type  = \"text\"\n\t\t\tinput.setAttribute('value', value);\n\t\t\tinput.setAttribute('placeholder', label)\n\t\t\tinput.setAttribute('title', label)\n\t\t\tinput.dataset.key  = label\n\t\t\tinput.dataset.lang = lang\n\n\t\t\tinput.addEventListener(\"change\", function(e){\n\t\t\t\t//console.log(\"e:\",e.target.value, e);\n\t\t\t\tsave_lang_file(e.target, lang)\n\t\t\t})\n\n\t\t\tline.appendChild(input)\n\t\t}\n\n\n\treturn line\n}//end build_line\n\n\n\n/**\n* SAVE_LANG_FILE\n*/\nconst save_lang_file = (node, lang) => {\n\t\n\tconst data = {}\n\n\tconst ar_inputs = document.querySelectorAll(\"input[data-lang='\"+lang+\"']\")\n\tfor (let i = 0; i < ar_inputs.length; i++) {\n\t\t\n\t\tconst key \t= ar_inputs[i].dataset.key\n\t\tconst value = ar_inputs[i].value\n\t\t\n\t\tdata[key] = value\n\t}\n\t//console.log(\"data:\",data);\n\n\n\trequest({\n\t\turl  : \"trigger.translator.php\",\n\t\tbody : {\n\t\t\tlang : lang,\n\t\t\tdata : data\n\t\t}\n\t})\n\t.then((response)=>{\n\t\t//console.log(\"response:\",response);\n\n\t\tnode.classList.remove(\"saved\",\"not_saved\")\n\n\t\tif (response.result<1) {\t\t\t\n\t\t\talert(\"Error on save file \" + lang + \".json\");\n\t\t\tnode.classList.add(\"not_saved\")\t\n\t\t}else{\t\t\t\n\t\t\tconsole.log(\"File saved!:\", response);\n\t\t\t//alert(\"File saved successfully! \\nname:\"+ lang + \".json\");\n\t\t\tnode.classList.add(\"saved\")\t\t\t\t\t\t\n\t\t}\n\n\t\tsetTimeout(()=>{\n\t\t\tnode.classList.remove(\"saved\",\"not_saved\")\n\t\t},3000)\n\t})\n\n\n\treturn true\n}//end save_lang_file\n\n\n"]}