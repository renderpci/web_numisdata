"use strict";import{chartjs_chart_wrapper}from"./chartjs-chart-wrapper.js";import{COLOR_PALETTE,COLOR_PICKER_WIDTH}from"../chart-wrapper.js";export function bar_chart_wrapper(t,r,e){chartjs_chart_wrapper.call(this,t,e),this._data=void 0,Array.isArray(r)?(this._check_array_valid(r),this._data=this._parse_array(r)):(this._check_object_valid(r),this._data=this._parse_object(r)),this._ylabel=e.ylabel||null,this._bar_colors=Array(this._data.labels.length).fill(COLOR_PALETTE[0])}Object.setPrototypeOf(bar_chart_wrapper.prototype,chartjs_chart_wrapper.prototype),bar_chart_wrapper.prototype._check_array_valid=function(t){if(!t.length)throw new Error("Input array is empty!");const r=typeof t[0];if("number"!==r&&"string"!==r)throw new Error("Input array is not made of numbers or strings");for(const e of t.slice(1))if(typeof e!==r)throw new Error("Input array combines multiple types")},bar_chart_wrapper.prototype._parse_array=function(t){const r=t.filter(((t,r,e)=>e.indexOf(t)===r)),e=r.map((r=>t.filter((t=>t===r)).length));return{labels:r,values:e}},bar_chart_wrapper.prototype._check_object_valid=function(t){if(!t)throw new Error("Input data object is null or undefined");if(!Object.keys(t).length)throw new Error("Input data object is empty");const r=Object.values(t);for(const t of r)if("number"!=typeof t)throw new Error("A value in the input data object is not a number")},bar_chart_wrapper.prototype._parse_object=function(t){return{labels:Object.keys(t),values:Object.values(t)}},bar_chart_wrapper.prototype.get_bar_colors=function(){return this._bar_colors},bar_chart_wrapper.prototype.set_bar_colors=function(t){this._bar_colors=t,this.chart.data.datasets[0].backgroundColor=t,this.chart.update()},bar_chart_wrapper.prototype.set_bar_color=function(t,r){if("number"!=typeof t)throw new Error("Index is not a number");if(!Number.isInteger(t))throw new Error("Index is not an integer");if(t<0||t>=this._data.labels.length)throw new Error("Index is out of bounds");this._bar_colors[t]=r,this.chart.data.datasets[0].backgroundColor[t]=r,this.chart.update()},bar_chart_wrapper.prototype.render_plot=function(){chartjs_chart_wrapper.prototype.render_plot.call(this);const t={labels:this._data.labels,datasets:[{label:this._ylabel,data:this._data.values,backgroundColor:this._bar_colors}]},r={y:{title:{display:Boolean(this._ylabel),text:this._ylabel,font:{size:14}}}};this.chart=new Chart(this.canvas,{type:"bar",data:t,options:{scales:r,plugins:{legend:{display:!1}},normalized:!0}})},bar_chart_wrapper.prototype.render_control_panel=function(){chartjs_chart_wrapper.prototype.render_control_panel.call(this);const t=this,r=`${this.id_string()}_bar_select`,e=common.create_dom_element({element_type:"select",id:r,parent:this.controls_container});for(const[t,r]of this._data.labels.entries())common.create_dom_element({element_type:"option",value:String(t),text_content:r,parent:e});const o=common.create_dom_element({element_type:"div",id:`${this.id_string()}_color_picker_container`,parent:this.controls_container}),a=new window.iro.ColorPicker(o,{color:this._bar_colors[0],width:COLOR_PICKER_WIDTH,layoutDirection:"horizontal",layout:[{component:window.iro.ui.Wheel},{component:window.iro.ui.Slider},{component:window.iro.ui.Slider,options:{sliderType:"alpha"}}]});e.addEventListener("change",(()=>{const r=Number(e.value);a.color.set(t._bar_colors[r])})),a.on("color:change",(function(r){const o=Number(e.value);t.set_bar_color(o,r.rgbaString)}))};
//# sourceMappingURL=bar-chart-wrapper-min.js.map