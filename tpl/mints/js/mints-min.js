"use strict";var mints={search_options:{},form:null,pagination:null,list:null,form_node:null,form_container:null,rows_container:null,set_up:function(e){const n=this;n.form_container=e.form_container,n.rows_container=e.rows_container,n.form=new form_factory;const t=n.render_form();return n.form_container.appendChild(t),n.pagination={total:null,limit:10,offset:0,n_nodes:8},event_manager.subscribe("paginate",(function(e){n.pagination.offset=e,n.form_submit()})),!0},render_form:function(){const e=this,n=new DocumentFragment,t=common.create_dom_element({element_type:"div",class_name:"form-row fields",parent:n});e.form.item_factory({id:"name",name:"name",label:tstring.mint||"Mint",q_column:"name",eq:"LIKE",eq_in:"%",eq_out:"%",parent:t,callback:function(n){e.form.activate_autocomplete({form_item:n,table:"mints"})}}),e.form.item_factory({id:"place",name:"place",label:tstring.place||"Place",q_column:"place",eq:"LIKE",eq_in:"%",eq_out:"%",parent:t,callback:function(n){e.form.activate_autocomplete({form_item:n,table:"mints"})}});const o=common.create_dom_element({element_type:"div",class_name:"form-group field button_submit",parent:n});common.create_dom_element({element_type:"input",type:"submit",id:"submit",value:tstring.search||"Search",class_name:"btn btn-light btn-block primary",parent:o}).addEventListener("click",(function(n){n.preventDefault(),e.pagination={total:null,limit:10,offset:0,n_nodes:8},e.form_submit()}));const i=e.form.build_operators_node();return n.appendChild(i),e.form.node=common.create_dom_element({element_type:"form",id:"search_form",class_name:"form-inline form_factory"}),e.form.node.appendChild(n),e.form.node},form_submit:function(){const e=this,n=e.form.node;if(!n)return new Promise((function(e){console.error("Error on submit. Invalid form_node.",n),e(!1)}));const t=e.rows_container;return e.pagination.total?t.classList.add("loading"):page.add_spinner(t),new Promise((function(n){const o=e.pagination.limit,i=e.pagination.offset,r=e.form.build_filter(),a=e.form.parse_sql_filter(r,[]),l=a?"("+a+")":null;!0===SHOW_DEBUG&&console.log("-> coins form_submit sql_filter:",l),data_manager.request({body:{dedalo_get:"records",table:"mints",ar_fields:["*"],sql_filter:l,limit:o,count:!0,offset:i,order:"name",process_result:null}}).then((function(o){console.log("--------------- api_response:",o);const r=page.parse_mint_data(o.result),a=o.total;e.pagination.total=a,e.pagination.offset=i,r||(t.classList.remove("loading"),n(null)),function(){for(;t.hasChildNodes();)t.removeChild(t.lastChild);t.classList.remove("loading")}(),e.list=e.list||new list_factory,e.list.init({data:r,fn_row_builder:e.list_row_builder,pagination:e.pagination,caller:e}),e.list.render_list().then((function(e){e&&t.appendChild(e),n(e)}))}));const s=document.querySelector(".rows_container");s&&s.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}))},list_row_builder:function(e,n){return mints_rows.draw_item(e)}};