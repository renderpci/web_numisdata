"use strict";var _t;function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var tpl_common={export_data_json:[],export_data_csv:[],t:(_t={obverse_image:"Obverse image",reverse_image:"Reverse image",section_id:"ID",site:"Site",findspot:"Findspot",type_of_site:"Type of site",weight:"Weight",collection:"Collection",funds:"Funds",bibliographic_ref:"Bibliographic ref",info:"Info",catalogue:"Catalogue",catalogue_number:"Catalogue number",authority:"Authority",mint:"Mint",start_date:"Start date",end_date:"End date",obverse_legend:"Obverse legend",obverse_design:"Obverse design",obverse_symbol:"Obverse symbol",reverse_legend:"Reverse legend",reverse_design:"Reverse design",reverse_symbol:"Reverse symbol",denomination:"Denomination",chronology:"Chronology",material:"Material",material_links:"Material links",diameter:"Diameter",axis:"Axis"},_defineProperty(_t,"funds","Funds"),_defineProperty(_t,"bibliography","Bibliography"),_defineProperty(_t,"equivalents","Equivalents"),_defineProperty(_t,"uri","URI"),_defineProperty(_t,"site_geo_lat","Site GEO lat"),_defineProperty(_t,"site_geo_lon","Site GEO lon"),_t),setup:function(){return $("a.gallery").colorbox({rel:"gal",previous:" < ",next:" > "}),!0},draw_rows:function(e){!0===SHOW_DEBUG&&console.log("draw_rows - options:",e);for(var t=this,a=document.getElementById(e.target),n=e.ar_rows;a.hasChildNodes();)a.removeChild(a.lastChild);t.export_data_json=[],t.export_data_csv=[];for(var o=n.length,i=0,_=n.length,l=0;l<_;l++){var r=n[l],s=common.create_dom_element({element_type:"div",parent:a,class_name:"group_container"});if(tpl_common.draw_row_tipo(r,s),r.monedas)for(var c=common.create_dom_element({element_type:"div",parent:s,class_name:"monedas_wrapper"}),m=r.monedas.length,d=0;d<m;d++){var p=r.monedas[d];p.tipo_object=r,t.draw_row_moneda(p,c),i++}}var v=tstring.tipos||"Tipos",u=tstring.monedas||"Monedas",g=t.create_dom_element({element_type:"div",id:"total_records"});t.create_dom_element({element_type:"i",class_name:"fa fas fa-eye",parent:g}).addEventListener("click",function(e){t.toggle_tipos()});t.create_dom_element({element_type:"span",inner_html:v+": "+o,parent:g});t.create_dom_element({element_type:"i",class_name:"fa fas fa-eye",parent:g}).addEventListener("click",function(e){t.toggle_monedas()});t.create_dom_element({element_type:"span",inner_html:u+": "+i,parent:g});var f=document.querySelector(".pagination");if(f)for(;f.hasChildNodes();)f.removeChild(f.lastChild);if(e.total&&(document.getElementById("catalogo_rows_list").prepend(g),f)){var b=paginator.build_page_nodes(e.total,e.limit,e.offset,10);t.build_paginator_html(b,f,catalogo.search_rows);t.create_dom_element({element_type:"div",class_name:"total_records_info",inner_html:(tstring.total||"Total")+": "+e.total+" "+tstring.tipos,parent:f});for(var y=document.querySelector(".pagination_footer");y.hasChildNodes();)y.removeChild(y.lastChild);var h=f.cloneNode(!0);y.appendChild(h),h.addEventListener("click",t.paginator_click_event)}var x=t.export_data_json.filter(function(e){return"coin"===e.data_ref}),j=t.export_data_json.filter(function(e){return"type"===e.data_ref}),w=["data_ref","type_id","data_lang","data_source_url","data_source_org"],k=x.length;for(l=0;l<k;l++){var E=x[l];if(E.types&&E.types.length>0){var A=E.types[0];j.filter(function(e){return e.type_id===A}).forEach(function(e){for(var t in e)-1===w.indexOf(t)&&(E.hasOwnProperty(t)?!0===SHOW_DEBUG&&console.log("Warning: type property is already used by coin (IGNORED!) ",t):E[t]=e[t])})}}var z=common.create_dom_element({element_type:"div",class_name:"download_buttons_wrapper",parent:a}),O=t.build_download_data_link({obj_to_save:x,data_type:"json",file_name:"numisdata_valencia_list.json"});z.appendChild(O);var S=t.build_download_data_link({obj_to_save:x,data_type:"csv",file_name:"numisdata_valencia_list.csv"});z.appendChild(S);var C=a.querySelectorAll(".show_tooltip");return t.activate_tooltips(C),!0},draw_row_moneda:function(e,t){var a=this.t,n={data_ref:"coin",types:JSON.parse(e.tipos)},o=e;SHOW_DEBUG,n[a.section_id]=o.section_id||"";var i=this.create_dom_element({element_type:"div",class_name:"row_container",parent:t});i.addEventListener("click",function(){window.open("mon/"+e.section_id,"_blank")},!1);var _=this.create_dom_element({element_type:"div",class_name:"imagen_anverso",parent:i});if(s=void 0!==o.imagen_anverso[0]?o.imagen_anverso[0].image:null){var l=this.build_thumb_url(s);_.style.backgroundImage="url("+l+")";var r=this.build_quality_image_url(s,"original")}n[a.obverse_image]=r;var s,c=this.create_dom_element({element_type:"div",class_name:"imagen_reverso",parent:i});if(s=void 0!==o.imagen_reverso[0]?o.imagen_reverso[0].image:null){l=this.build_thumb_url(s);c.style.backgroundImage="url("+l+")";r=this.build_quality_image_url(s,"original")}n[a.reverse_image]=r;var m=this.create_dom_element({element_type:"div",class_name:"right_block",parent:i});if(o.coleccion){var d=o.coleccion;o.numero&&(d+=" | "+o.numero);this.create_dom_element({element_type:"div",class_name:"section_id",text_content:d,parent:m})}if(n[a.collection]=o.coleccion||"",o.hallazgo)this.create_dom_element({element_type:"div",class_name:"hallazgo",text_content:o.hallazgo,parent:m});if(n[a.site]=o.hallazgo||"",o.peso){var p=o.peso?o.peso.replace(".",",")+" g":"";this.create_dom_element({element_type:"div",class_name:"peso",text_content:p,parent:m})}if(n[a.weight]=o.peso?o.peso.replace(".",","):"",o.bibliografia)this.create_dom_element({element_type:"div",class_name:"bibliografia",text_content:o.bibliografia,parent:m});if(n[a.bibliographic_ref]=o.bibliografia||"",o.info_publica)this.create_dom_element({element_type:"div",class_name:"info_publica",inner_html:o.info_publica,parent:m});return n[a.info]=o.info_publica||"",this.to_export_data_json(n),!0},draw_row_tipo:function(e,t){var a=this,n=a.t,o={data_ref:"type",type_id:e.section_id},i=common.create_dom_element({element_type:"div",class_name:"tipo_header_wrapper heading",parent:t}),_="";if(e.autoridad){var l=e.autoridad;_+=" "+(l=l.replace(",",", "))}if(o[n.authority]=void 0!==l?l:"",e.autoridad)common.create_dom_element({element_type:"h1",class_name:"catalogo_num",text_content:_,parent:i});if(e.ceca_text){var r=common.create_dom_element({element_type:"div",parent:i,class_name:"ceca_info info_line"}),s=common.create_dom_element({element_type:"div",parent:r,class_name:"info_value",text_content:e.ceca_text});if(e.ceca_links)e.ceca_links.split(" | ").forEach(function(e){var t=a.create_dom_element({element_type:"a",class_name:"fa fas fa-external-link show_tooltip",parent:s});t.setAttribute("target","_blank"),t.setAttribute("href",e),t.setAttribute("title","Go to: "+e),a.add_tool_tip(t)})}if(o[n.mint]=e.ceca_text||"",e.denominacion){var c=common.create_dom_element({element_type:"div",parent:i,class_name:"denominacion_info info_line"});common.create_dom_element({element_type:"div",parent:c,class_name:"info_label",text_content:" | "});var m=common.create_dom_element({element_type:"div",parent:c,class_name:"info_value",text_content:e.denominacion});if(e.denominacion_iri)e.denominacion_iri.split(" | ").forEach(function(e){var t=a.create_dom_element({element_type:"a",class_name:"fa fas fa-external-link show_tooltip",parent:m});t.setAttribute("target","_blank"),t.setAttribute("href",e),t.setAttribute("title","Go to: "+e),a.add_tool_tip(t)})}if(o[n.denomination]=e.denominacion||"",e.fecha_inicio){var d=common.create_dom_element({element_type:"div",parent:i,class_name:"fecha_info info_line"});common.create_dom_element({element_type:"div",parent:d,class_name:"info_label",text_content:" | "});var p=e.fecha_inicio;e.fecha_fin&&(p+=" -> "+e.fecha_fin),common.create_dom_element({element_type:"div",parent:d,class_name:"info_value",text_content:p})}o[n.start_date]=e.fecha_inicio||"",o[n.end_date]=e.fecha_fin||"";a.create_dom_element({element_type:"div",class_name:"tipo_add_info",parent:t});return a.to_export_data_json(o),!0},build_detail:function(e){var t=this,a=t.t;if(!e.tipos||e.tipos.length<1)return console.warn("Invalid 'tipos' for current coin:",e),!1;var n={data_ref:"coin",types:JSON.parse(e.tipos)},o=e.tipo_object,i=t.create_dom_element({element_type:"div",class_name:"detail_container"}),_=t.create_dom_element({element_type:"div",class_name:"left_detail",parent:i}),l=t.create_dom_element({element_type:"div",class_name:"imagen_anverso gal",parent:_});if(l.setAttribute("rel","gal"),m=void 0!==e.imagen_anverso[0]?e.imagen_anverso[0].image:null){var r=t.build_thumb_url(m,320,320);l.style.backgroundImage="url("+r+")"}var s=t.create_dom_element({element_type:"div",class_name:"imagen_anverso_big"}),c=t.build_quality_image_url(m,"original");s.style.backgroundImage="url("+c+")",n[a.obverse_image]=c,(p=t.create_dom_element({element_type:"a",class_name:"fa fas fa-arrow-circle-down download_image",parent:s})).setAttribute("download","numisdata_valencia-"+e.section_id+"-A.jpg"),p.setAttribute("target","_blank"),p.setAttribute("href",c),l.addEventListener("click",function(e){e.stopPropagation(),$.colorbox({html:s,transition:"none",speed:300,rel:"gal"})});var m,d=t.create_dom_element({element_type:"div",class_name:"imagen_reverso gal",parent:_});if(d.setAttribute("rel","gal"),m=void 0!==e.imagen_reverso[0]?e.imagen_reverso[0].image:null){r=t.build_thumb_url(m,320,320);d.style.backgroundImage="url("+r+")"}var p,v=t.create_dom_element({element_type:"div",class_name:"imagen_reverso_big"});c=t.build_quality_image_url(m,"original");v.style.backgroundImage="url("+c+")",n[a.reverse_image]=c,(p=t.create_dom_element({element_type:"a",class_name:"fa fas fa-arrow-circle-down download_image",parent:v})).setAttribute("download","numisdata_valencia-"+e.section_id+"-R.jpg"),p.setAttribute("target","_blank"),p.setAttribute("href",c),d.addEventListener("click",function(e){e.stopPropagation(),$.colorbox({html:v,transition:"none",speed:300,rel:"gal"})}),s.addEventListener("click",function(e){e.stopPropagation(),e.target.classList.contains("imagen_anverso_big")&&d.click()}),v.addEventListener("click",function(e){e.stopPropagation(),e.target.classList.contains("imagen_reverso_big")&&l.click()});var u=t.create_dom_element({element_type:"div",class_name:"right_detail",parent:i});if(e.coleccion){var g=t.create_dom_element({element_type:"div",class_name:"line",parent:u});t.create_dom_element({element_type:"span",class_name:"label label2em",text_content:tstring.coleccion||"coleccion",parent:g});var f=e.coleccion;e.numero&&(f+=" | "+e.numero),t.create_dom_element({element_type:"div",class_name:"section_id",inner_html:f,parent:g})}n[a.collection]=e.coleccion||"";var b=t.create_dom_element({element_type:"div",class_name:"separator hallazgo_detail",parent:u});if(e.hallazgo){g=t.create_dom_element({element_type:"div",class_name:"line",parent:b});t.create_dom_element({element_type:"span",class_name:"label",text_content:tstring.yacimiento||"Yacimiento",parent:g}),t.create_dom_element({element_type:"div",class_name:"hallazgo",text_content:e.hallazgo,parent:g})}n[a.site]=e.hallazgo||"";var y="",h="";if(void 0!==e.hallazgo_dato[0]&&(y=t.extract_geo(e.hallazgo_dato[0],"lat"),h=t.extract_geo(e.hallazgo_dato[0],"lon")),n[a.site_geo_lat]=y,n[a.site_geo_lon]=h,void 0!==e.hallazgo_dato[0]&&void 0!==e.hallazgo_dato[0].tipologia){g=t.create_dom_element({element_type:"div",class_name:"line",parent:b});t.create_dom_element({element_type:"span",class_name:"label",text_content:tstring.tipo_de_yacimiento||"Tipo de yacimiento",parent:g}),t.create_dom_element({element_type:"div",class_name:"tipo_de_hallazgo",text_content:e.hallazgo_dato[0].tipologia,parent:g})}if(n[a.type_of_site]=void 0!==e.hallazgo_dato[0]&&void 0!==e.hallazgo_dato[0].tipologia?e.hallazgo_dato[0].tipologia:"",void 0!==e.hallazgo_dato[0]&&void 0!==e.hallazgo_dato[0].municipio){g=t.create_dom_element({element_type:"div",class_name:"line",parent:b});t.create_dom_element({element_type:"span",class_name:"label",text_content:tstring.localizacion||"Localización",parent:g});var x=void 0!==e.hallazgo_dato[0].municipio?e.hallazgo_dato[0].municipio:"";t.create_dom_element({element_type:"div",class_name:"localizacion",text_content:x,parent:g})}n[a.findspot]=void 0!==e.hallazgo_dato[0]&&void 0!==e.hallazgo_dato[0].municipio?e.hallazgo_dato[0].municipio:"";var j=t.create_dom_element({element_type:"div",class_name:"separator ceca_detail",parent:u});if(e.ceca){g=t.create_dom_element({element_type:"div",class_name:"line",parent:j});t.create_dom_element({element_type:"span",class_name:"label",text_content:tstring.ceca||"Ceca",parent:g});var w=t.create_dom_element({element_type:"div",class_name:"ceca",text_content:t.remove_string_double_values(e.ceca,","),parent:g});if(e.tipo_object.ceca_links)e.tipo_object.ceca_links.split(" | ").forEach(function(e){var a=t.create_dom_element({element_type:"a",class_name:"fa fas fa-external-link show_tooltip",parent:w});a.setAttribute("target","_blank"),a.setAttribute("href",e),a.setAttribute("title","Go to: "+e),t.add_tool_tip(a)})}if(n[a.mint]=e.ceca||"",e.cronologia){g=t.create_dom_element({element_type:"div",class_name:"line",parent:j});t.create_dom_element({element_type:"span",class_name:"label",text_content:tstring.cronologia||"Cronología",parent:g});var k=split(e.cronologia);t.create_dom_element({element_type:"div",class_name:"cronologia",text_content:k[0],parent:g})}if(n[a.start_date]=o.fecha_inicio||"",n[a.end_date]=o.fecha_fin||"",e.tipo_object.autoridad){g=t.create_dom_element({element_type:"div",class_name:"line",parent:j});t.create_dom_element({element_type:"span",class_name:"label",text_content:tstring.autoridad||"Creador",parent:g});var E="";if(E.length<1){var A=e.tipo_object.autoridad;E=A=A.replace(",",", ")}var z=t.create_dom_element({element_type:"div",class_name:"autoridad",text_content:E,parent:g});if(e.tipo_object.autoridad_dato&&void 0!==e.tipo_object.autoridad_dato[0]&&void 0!==e.tipo_object.autoridad_dato[0].uri)split(e.tipo_object.autoridad_dato[0].uri).forEach(function(e){var a=t.create_dom_element({element_type:"a",class_name:"fa fas fa-external-link show_tooltip",parent:z});a.setAttribute("target","_blank"),a.setAttribute("href",e),a.setAttribute("title","Go to: "+e),t.add_tool_tip(a)});if(e.tipo_object.autoridad_rol&&e.tipo_object.autoridad_rol.length>0){g=t.create_dom_element({element_type:"div",class_name:"line",parent:j});t.create_dom_element({element_type:"span",class_name:"label",text_content:tstring.rol||"Rol",parent:g});t.create_dom_element({element_type:"div",class_name:"role",text_content:t.clean_data_string(e.tipo_object.autoridad_rol),parent:g})}}if(n[a.authority]=void 0!==E?E:"",e.tipo_object.denominacion){g=t.create_dom_element({element_type:"div",class_name:"line",parent:j});t.create_dom_element({element_type:"span",class_name:"label",text_content:tstring.denominacion||"Denominacion",parent:g});var O=t.create_dom_element({element_type:"div",class_name:"denominacion",text_content:e.tipo_object.denominacion,parent:g});if(e.tipo_object.denominacion_iri)e.tipo_object.denominacion_iri.split(" | ").forEach(function(e){var a=t.create_dom_element({element_type:"a",class_name:"fa fas fa-external-link show_tooltip",parent:O});a.setAttribute("target","_blank"),a.setAttribute("href",e),a.setAttribute("title","Go to: "+e),t.add_tool_tip(a)})}if(n[a.denomination]=e.tipo_object.denominacion||"",e.tipo_object.material){g=t.create_dom_element({element_type:"div",class_name:"line",parent:j});t.create_dom_element({element_type:"span",class_name:"label",text_content:tstring.material||"Material",parent:g});var S=t.create_dom_element({element_type:"div",class_name:"material",text_content:t.clean_data_string(e.tipo_object.material),parent:g});if(e.tipo_object.material_links)e.tipo_object.material_links.split(" | ").forEach(function(e){var a=t.create_dom_element({element_type:"a",class_name:"fa fas fa-external-link show_tooltip",parent:S});a.setAttribute("target","_blank"),a.setAttribute("href",e),a.setAttribute("title","Go to: "+e),t.add_tool_tip(a)})}n[a.material]=e.tipo_object.material||"",n[a.material_links]=e.tipo_object.material_links||"";var C=t.create_dom_element({element_type:"div",class_name:"separator medida_detail",parent:u});if(e.peso){g=t.create_dom_element({element_type:"div",class_name:"line",parent:C});t.create_dom_element({element_type:"span",class_name:"label",text_content:tstring.peso||"Peso",parent:g}),t.create_dom_element({element_type:"div",class_name:"peso",text_content:e.peso?e.peso.replace(".",",")+" g":"",parent:g})}if(n[a.weight]=e.peso?e.peso.replace(".",","):"",e.diametro){g=t.create_dom_element({element_type:"div",class_name:"line",parent:C});t.create_dom_element({element_type:"span",class_name:"label",text_content:tstring.diametro||"Diámetro",parent:g}),t.create_dom_element({element_type:"div",class_name:"diametro",text_content:e.diametro+" mm",parent:g})}if(n[a.diameter]=e.diametro||"",e.cuno&&e.cuno.length>0){g=t.create_dom_element({element_type:"div",class_name:"line",parent:C});t.create_dom_element({element_type:"span",class_name:"label",text_content:tstring.posicion_cunos||"Posición de cuños",parent:g}),t.create_dom_element({element_type:"div",class_name:"posicion_cunos",text_content:e.cuno+" h",parent:g})}n[a.axis]=e.cuno||"";var B=t.create_dom_element({element_type:"div",class_name:"separator anverso_detail",parent:u});g=t.create_dom_element({element_type:"div",class_name:"line",parent:B});if(t.create_dom_element({element_type:"span",class_name:"label anverso_label",text_content:tstring.anverso||"ANVERSO",parent:g}),t.create_dom_element({element_type:"div",class_name:"leyenda_anverso",parent:g}),e.tipo_object.leyenda_anverso){g=t.create_dom_element({element_type:"div",class_name:"line",parent:B});t.create_dom_element({element_type:"span",class_name:"label",text_content:tstring.leyenda||"Leyenda",parent:g});var L=t.replace_dedalo_paths(e.tipo_object.leyenda_anverso)+"<br>"+(e.tipo_object.leyenda_anverso_transcripcion||"");t.create_dom_element({element_type:"div",class_name:"leyenda_anverso",inner_html:L,parent:g})}if(e.tipo_object.tipo_anverso){g=t.create_dom_element({element_type:"div",class_name:"line",parent:B});t.create_dom_element({element_type:"span",class_name:"label",text_content:tstring.diseno||"Diseño",parent:g}),t.create_dom_element({element_type:"div",class_name:"diseno_anverso",inner_html:e.tipo_object.tipo_anverso,parent:g})}if(e.tipo_object.simbolo_anverso){g=t.create_dom_element({element_type:"div",class_name:"line",parent:B});t.create_dom_element({element_type:"span",class_name:"label",text_content:tstring.simbolo||"Símbolo",parent:g}),t.create_dom_element({element_type:"div",class_name:"simbolo_anverso",inner_html:t.clean_data_string(e.tipo_object.simbolo_anverso),parent:g})}if(n[a.obverse_legend]=e.tipo_object.leyenda_anverso||"",n[a.obverse_design]=e.tipo_object.tipo_anverso||"",n[a.obverse_symbol]=e.tipo_object.simbolo_anverso||"",e.tipo_object.leyenda_reverso||e.tipo_object.tipo_reverso||e.tipo_object.simbolo_reverso){var q=t.create_dom_element({element_type:"div",class_name:"separator reverso_detail",parent:u});g=t.create_dom_element({element_type:"div",class_name:"line",parent:q});t.create_dom_element({element_type:"span",class_name:"label reverso_label",text_content:tstring.reverso||"REVERSO",parent:g}),t.create_dom_element({element_type:"div",class_name:"leyenda_reverso",parent:g})}if(e.tipo_object.leyenda_reverso){g=t.create_dom_element({element_type:"div",class_name:"line",parent:q});t.create_dom_element({element_type:"span",class_name:"label",text_content:tstring.leyenda||"Leyenda",parent:g});L=t.replace_dedalo_paths(e.tipo_object.leyenda_reverso)+"<br>"+(e.tipo_object.leyenda_reverso_transcripcion||"");t.create_dom_element({element_type:"div",class_name:"leyenda_reverso",inner_html:L,parent:g})}if(e.tipo_object.tipo_reverso){g=t.create_dom_element({element_type:"div",class_name:"line",parent:q});t.create_dom_element({element_type:"span",class_name:"label",text_content:tstring.diseno||"Diseño",parent:g}),t.create_dom_element({element_type:"div",class_name:"diseno_reverso",inner_html:e.tipo_object.tipo_reverso,parent:g})}if(e.tipo_object.simbolo_reverso){g=t.create_dom_element({element_type:"div",class_name:"line",parent:q});t.create_dom_element({element_type:"span",class_name:"label",text_content:tstring.simbolo||"Símbolo",parent:g}),t.create_dom_element({element_type:"div",class_name:"simbolo_reverso",inner_html:t.clean_data_string(e.tipo_object.simbolo_reverso),parent:g})}n[a.reverse_legend]=e.tipo_object.leyenda_reverso||"",n[a.reverse_design]=e.tipo_object.tipo_reverso||"",n[a.reverse_symbol]=e.tipo_object.simbolo_reverso||"";var R=t.create_dom_element({element_type:"div",class_name:"separator biblio_detail",parent:u});if(e.fondo){g=t.create_dom_element({element_type:"div",class_name:"line",parent:R});t.create_dom_element({element_type:"span",class_name:"label",text_content:tstring.fondo||"fondo",parent:g}),t.create_dom_element({element_type:"div",class_name:"fondo",inner_html:e.fondo,parent:g})}n[a.funds]=e.fondo||"";var D=[];if(e.bibliografia&&e.bibliografia_ref)for(var G=split(e.bibliografia),I=0;I<G.length;I++){var N=G[I],P="",U="";e.bibliografia_ref&&void 0!==(U=split(e.bibliografia_ref))[I]&&(U=U[I]),e.bibliografia_paginas&&void 0!==(P=split(e.bibliografia_paginas))[I]&&(P=P[I]);g=t.create_dom_element({element_type:"div",class_name:"line",parent:R});t.create_dom_element({element_type:"span",class_name:"label",text_content:tstring.bibliografia||"Bibliografía",parent:g});var W=N+" Ref: "+U+" Pag. "+P;D.push(W),t.create_dom_element({element_type:"div",class_name:"bibliografia",text_content:W,parent:g})}if(n[a.bibliographic_ref]=D.join(", "),e.publicaciones&&e.publicaciones.forEach(function(e){var a=t.create_dom_element({element_type:"div",class_name:"line",parent:R});t.create_dom_element({element_type:"span",class_name:"label",text_content:tstring.bibliografia||"Bibliografía",parent:a});var n=e.autoria+" "+e.titulo+" "+e.fecha_publicacion;t.create_dom_element({element_type:"div",class_name:"publicaciones",text_content:n,parent:a})}),n[a.bibliography]="undefined"!=typeof bibliografia_title?bibliografia_title:"",e.info_publica&&'<br data-mce-bogus="1">'!==e.info_publica){g=t.create_dom_element({element_type:"div",class_name:"line",parent:R});t.create_dom_element({element_type:"span",class_name:"label",text_content:tstring.notas||"Notas",parent:g}),t.create_dom_element({element_type:"div",class_name:"notas",inner_html:e.info_publica,parent:g})}n[a.info]=e.info_publica||"";var H=t.create_dom_element({element_type:"div",class_name:"separator uri_detail",parent:u});if(e.tipo_object.catalogo){g=t.create_dom_element({element_type:"div",class_name:"line",parent:H});t.create_dom_element({element_type:"span",class_name:"label",text_content:tstring.refeferencia_bibliografica||"Ref bibliografia",parent:g});var M=[];M.push(e.tipo_object.catalogo),e.tipo_object.numero_catalogo&&M.push(e.tipo_object.numero_catalogo),E&&M.push(E);var T=M.join(" ");T=t.clean_string(T);var J=t.create_dom_element({element_type:"div",class_name:"tipo show_tooltip",inner_html:T,parent:g});void 0!==e.tipo_object.catalogo_dato[0]&&e.tipo_object.catalogo_dato[0].publicacion.length>0&&(J.setAttribute("title",t.clean_string(e.tipo_object.catalogo_dato[0].publicacion)),t.add_tool_tip(J))}if(n[a.catalogue]=e.tipo_object.catalogo||"",n[a.catalogue_number]=e.tipo_object.numero_catalogo||"",e.tipo_object.equivalentes&&e.tipo_object.equivalentes.length>0){g=t.create_dom_element({element_type:"div",class_name:"line",parent:H});t.create_dom_element({element_type:"span",class_name:"label",text_content:"",parent:g});var V=t.create_dom_element({element_type:"div",class_name:"equivalentes",parent:g}),F=e.tipo_object.equivalentes_catalogo_dato,Y=e.tipo_object.equivalentes.split("<br>"),K=0;Y.forEach(function(e){var a=e.split(" | ");if(console.log("item_parts:",a,K),void 0!==F[K]&&a[0]===F[K].catalogo){var n=a.slice(0,2),o=t.create_dom_element({element_type:"div",class_name:"show_tooltip",text_content:n.join(" | "),parent:V});F[K].publicacion.length>0&&(o.setAttribute("title",t.clean_string(F[K].publicacion)),t.add_tool_tip(o))}K++})}var Q=e.tipo_object.equivalentes.replace(/<br>/g,", ");n[a.equivalents]=Q;g=t.create_dom_element({element_type:"div",class_name:"line uri_line",parent:H});t.create_dom_element({element_type:"span",class_name:"label",text_content:tstring.uri||"URI",parent:g});var X=t.create_dom_element({element_type:"div",class_name:"uri",parent:g}),Z="https://numisdata.org/valencia/mon/"+e.section_id;t.create_dom_element({element_type:"a",text_content:Z,href:Z,parent:X}),n[a.uri]=Z||"",t.to_export_data_json(n),SHOW_DEBUG;var ee=i.querySelectorAll(".show_tooltip");return t.activate_tooltips(ee),i},clean_data_string:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" | ",a=e.split(t),n=[];a.forEach(function(e){e.length>0&&n.push(e)});var o=n.join(t);return o},clean_string:function(e){return"|"===(e=e.trim()).slice(-1)&&(e=e.slice(0,-1)),e},extract_geo:function(e,t){var a="",n=JSON.parse(e.lugar);return void 0!==n[0]&&void 0!==n[0].layer_data[0]&&void 0!==n[0].layer_data[0][t]&&(a=n[0].layer_data[0][t]),a},open_detail:function(e,t){var a=this.build_detail(t);return $.colorbox({html:a,transition:"none",speed:300}),!0},build_thumb_url:function(e,t,a){if(!e||e.length<1)return!1;var n=e,o=t||380,i=a||360,_="/image/"+n.split("/image/").pop();return n=(n=n.replace("/media_test/media_numisdata_valencia/dedalo/","/")).replace("/media/dedalo/","/"),n="https://valencia.numisdata.org/dedalo/lib/dedalo/media_engine/img.php?m=free&w="+o+"&h="+i+"&SID="+_},build_quality_image_url:function(e,t,a,n){if(!e||e.length<1)return!1;var o=e;return o=(o=o.replace("/media_test/media_numisdata_valencia/","/media/")).replace("/dedalo/media/","/media/"),"1.5MB"!==t&&(o=o.replace("/1.5MB/","/"+t+"/")),o="https://numisdata.org/valencia"+o},replace_dedalo_paths:function(e){return e=e.replace(/\/dedalo\/media\//g,"https://valencia.numisdata.org/dedalo/media/")},create_dom_element:function(e){var t=e.element_type,a=e.parent,n=e.class_name,o=e.style,i=e.data_set;void 0===i&&void 0!==e.dataset&&(i=e.dataset);var _=e.custom_function_events,l=e.title_label,r=e.text_node,s=e.text_content,c=e.inner_html,m=e.href,d=e.id,p=e.draggable,v=e.value,u=e.download,g=document.createElement(t);if(d&&(g.id=d),"a"===t&&(g.href=m||"javascript:;"),n&&(g.className=n),o)for(f in o)g.style[f]=o[f];if(l&&(g.title=l),i)for(var f in i)g.dataset[f]=i[f];if(v&&(g.value=v),_)for(var b=_.length,y=0;y<b;y++){var h=_[y].name,x=_[y].type,j=_[y].function_arguments;this.create_custom_events(g,x,h,j)}if(r)if("span"===t)g.textContent=r;else{var w=document.createElement("span");w.innerHTML=" "+r,g.appendChild(w)}else s?g.textContent=s:c&&(g.innerHTML=c);return a&&a.appendChild(g),p&&(g.draggable=p),u&&g.setAttribute("download",u),g},remove_string_double_values:function(e,t){if(null===e)return null;var a=e.split(t),n=[];return a.forEach(function(e){-1===n.indexOf(e)&&n.push(e)}),n.join(t)},toggle_monedas:function(){return $(".monedas_wrapper").toggle(),!0},toggle_tipos:function(){return $(".tipo_header_wrapper, .tipo_add_info").toggle(),!0},load_snippet:function(e,t){var a=page_globals.__WEB_TEMPLATE_WEB__+"/common/trigger.common.php",n={mode:"load_snippet",snippet_name:e};return common.get_json_data(a,n).then(function(e){if(!0===SHOW_DEBUG&&console.log("[common.load_snippet] response:",e),e||console.warn("[common.load_snippet] Error. Received response data is null"),t){var a=document.getElementById(t);a&&(a.innerHTML=e.result)}return e})},build_download_data_link:function(e){var t=e.obj_to_save,a=e.data_type||"json",n=e.file_name||"download_file",o="",i={};switch(a){case"csv":o="text/csv";var _=this.convert_json_to_csv(t);i=new Blob([_],{type:o,name:"file.csv"});break;case"json":default:o="application/json",i=new Blob([JSON.stringify(t,null,2)],{type:o,name:"file.json"})}var l=URL.createObjectURL(i),r=this.create_dom_element({element_type:"a",class_name:"download_data_link "+a+" button icon fa-download",href:l,download:n});return this.create_dom_element({element_type:"span",text_node:a,parent:r}),r},convert_json_to_csv:function(e){var t=e;if(!1===Array.isArray(t)&&(t=[t]),0===t.length)return!1;var a=Object.keys(t[0]),n=function(e,t){return null===t?"":t},o=t.map(function(e){return a.map(function(t){var a=e[t];return JSON.stringify(a,n)}).join(";")});return o.unshift(a.join(";")),o=o.join("\r\n"),SHOW_DEBUG,o},to_export_data_json:function(e){var t={data_source_org:"Numisdata Valencia",data_source_url:"https://numisdata.org/valencia/",data_lang:page_globals.WEB_CURRENT_LANG_CODE};for(var a in e){var n=e[a];t[a]=n}return SHOW_DEBUG,this.export_data_json.push(t),!0},add_tool_tip:function(e){return!0},build_paginator_html:function(e,t,a){var n=t;n.dataset.total=e.total;for(var o=e.ar_nodes,i=o.length,_=0;_<i;_++){var l=o[_],r=l.label,s="page "+l.type+" "+l.id;if(!1===l.active&&(s+=" unactive"),"previous"!==l.id&&"next"!==l.id&&"last"!==l.id&&"first"!==l.id||(r=""),!0===l.selected&&(s+=" selected"),"extra"===l.type){s=l.type;common.create_dom_element({element_type:"span",class_name:s,text_content:r,parent:n})}else{common.create_dom_element({element_type:"a",class_name:s,text_content:r,dataset:{offset:l.offset_value,active:l.active},parent:n});l.active}}return n.addEventListener("click",this.paginator_click_event),n},paginator_click_event:function(e){var t=e.target;if("true"!==t.dataset.active)return!1;var a=t.parentNode.dataset.total,n=t.dataset.offset,o=document.getElementById("search_form"),i=catalogo.search(o,null,n,a);return i.then(function(e){document.querySelector(".result").scrollIntoView({behavior:"smooth",block:"start",inline:"start"})}),i},activate_tooltips:function(e){SHOW_DEBUG,$(e).each(function(){new Tooltip($(this),{placement:"top"})})}};function split(e){return e.split(/,\s*/)}function extractLast(e){return split(e).pop()}tpl_common.setup();
//# sourceMappingURL=tpl_common-min.js.map