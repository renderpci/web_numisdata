"use strict";var main_home={form:null,image_wrapper:null,form_container:null,ar_images:[],set_up:function(e){const n=this;return n.image_wrapper=e.image_wrapper,n.form_container=e.form_container,n.ar_images=e.ar_images,n.form=new form_factory,n.form_node=n.render_form(),n.form_container.appendChild(n.form_node),n.main_coin_image(),!0},render_form:function(){const e=this,n=new DocumentFragment,t=common.create_dom_element({element_type:"div",class_name:"form-row fields",parent:n});e.form.item_factory({id:"global_search",name:"global_search",label:tstring.global_search||"global_search",q_column:"global_search",eq:"MATCH",eq_in:"",eq_out:"",class_name:"global_search",parent:t,callback:function(n){const o={id:"mint",name:"mint",class_name:"mint_form",label:tstring.mint||"mint",q_column:"p_mint",value_wrapper:['["','"]'],eq:"LIKE",eq_in:"%",eq_out:"%",is_term:!0,node_input:n.node_input,node_values:n.node_values,q_selected:n.q_selected,parent:t};e.form.activate_autocomplete({form_item:o,table:"catalog"});const a=n.node_input;let r;common.create_dom_element({element_type:"div",class_name:"search_operators_info",parent:a.parentNode}).addEventListener("click",(function(n){if(n.stopPropagation(),r)return r.remove(),void(r=null);r=e.form.full_text_search_operators_info(),a.parentNode.appendChild(r)})),window.addEventListener("click",(function(e){r&&!a.contains(e.target)&&(r.remove(),r=null)}))}});const o=common.create_dom_element({element_type:"div",class_name:"form-group field button_submit",parent:n});common.create_dom_element({element_type:"input",type:"submit",id:"submit",value:tstring.search||"Search",class_name:"btn btn-light btn-block primary",parent:o}).addEventListener("click",(function(n){n.preventDefault(),e.form_submit()}));const a=common.create_dom_element({element_type:"form",id:"search_form",class_name:"form-inline"});return a.appendChild(n),document.addEventListener("click",(function(){document.querySelector(".container_values").querySelector(".line_value")&&e.form_submit()})),a},form_submit:function(){const e=this.form_node;return new Promise(e?function(e){const n=document.getElementById("global_search");if(n){let t;document.querySelector(".line_value")?t=document.querySelector(".value_label").innerHTML:(t=n.value,t.leng<2&&e(!1));const o={$and:[{id:"global_search",field:"global_search",q:t,op:"="}]},a=psqo_factory.build_safe_psqo(o),r=psqo_factory.encode_psqo(a);window.location.href="./catalog/?psqo="+r,e(!0)}else e(!1)}:function(n){console.error("Error on submit. Invalid form_node.",e),n(!1)})},main_coin_image:function(){const e=this,n=common.create_dom_element({element_type:"div",class_name:"spinner",parent:e.image_wrapper});return function(t){const o=t[Math.floor(Math.random()*(t.length-0))+0].url,a="(ref_coins_image_reverse='"+o+"' OR ref_coins_image_obverse='"+o+"')",r={dedalo_get:"records",db_name:page_globals.WEB_DB,lang:page_globals.WEB_CURRENT_LANG_CODE,table:"types",ar_fields:["mint","mint_number","catalogue","number","denomination","section_id"],sql_filter:a,limit:1,count:!1,offset:0};data_manager.request({body:r}).then((function(t){const a=t.result[0],r=a&&a.mint?a.mint+" | ":"",m=a&&a.mint_number?a.mint_number+"/":"",_=a&&a.denomination?" | "+a.denomination:"",i=r+(a&&a.catalogue?a.catalogue:"")+" "+m+(a&&a.number?a.number:""),l=a&&a.section_id?page_globals.__WEB_ROOT_WEB__+"/type/"+a.section_id:"#",c=e.image_wrapper;c.href=l;const s=page_globals.__WEB_MEDIA_BASE_URL__+o,u=s.replace("/1.5MB/","/thumb/"),d=common.create_dom_element({element_type:"img",class_name:"main-coin-image",src:u,parent:c}),p=document.createElement("img");p.addEventListener("load",(function(){d.src=s,p.remove(),common.create_dom_element({element_type:"p",class_name:"img-text",text_content:i+_,parent:c})})),p.src=s,n.remove()}))}(e.ar_images),!0}};
//# sourceMappingURL=main_home-min.js.map