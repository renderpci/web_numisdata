"use strict";var hoard={section_id:null,export_data_container:null,row_detail:null,search_options:{},map:null,set_up:function(e){const t=this;return t.export_data_container=e.export_data_container,t.row_detail=e.row_detail,t.section_id=e.section_id,t.section_id?t.get_row_data({section_id:e.section_id}).then((function(e){if(console.log("[set_up->get_row_data] ar_rows:",e),e&&e.length>0){t.draw_row({target:t.row_detail,ar_rows:e}),t.row=e[0];const n=e[0].map;t.draw_map({map_data:n})}else t.row_detail.innerHTML="Sorry. Empty result for section_id: "+t.section_id})):t.row_detail.innerHTML="Error. Invalid section_id",!0},get_row_data:async function(e){const t=e.section_id,n="section_id="+parseInt(t);return data_manager.request({body:{dedalo_get:"records",db_name:page_globals.WEB_DB,lang:page_globals.WEB_CURRENT_LANG_CODE,table:"hoards",ar_fields:["*"],sql_filter:n,limit:1,count:!1,offset:0,resolve_portals_custom:{coins_data:"coins",bibliography_data:"bibliographic_references"}}}).then((function(e){if(!e.result)return console.warn("Empty result:",e),null;return page.parse_hoard_data(e.result)}))},draw_row:function(e){const t=e.ar_rows[0],n=e.target;if(!t)return console.warn("Warning! draw_row row_object no found in options"),null;for(this.row_object=t,SHOW_DEBUG;n.hasChildNodes();)n.removeChild(n.lastChild);const o=new DocumentFragment,a=common.create_dom_element({element_type:"div",class_name:"",parent:o});if(!0===dedalo_logged){common.create_dom_element({element_type:"a",class_name:"section_id go_to_dedalo",text_content:t.section_id,href:"/dedalo/lib/dedalo/main/?t=numisdata6&id="+t.section_id,parent:a}).setAttribute("target","_blank")}if(t.name&&t.name.length>0){const e=common.create_dom_element({element_type:"div",class_name:"line-tittle-wrap",parent:a});if(common.create_dom_element({element_type:"div",class_name:"line-tittle golden-color",text_content:t.name,parent:e}),t.place&&t.place.length>0){const n="| "+t.place;common.create_dom_element({element_type:"div",class_name:"info_value",text_content:n,parent:e})}}if(t.coins&&t.coins.length>0){const e=t.coins.length;common.create_dom_element({element_type:"div",class_name:"info_text_block",inner_html:(tstring.total_coins||"Total coins")+": "+e,parent:o})}if(t.public_info&&common.create_dom_element({element_type:"div",class_name:"info_text_block",inner_html:t.public_info,parent:o}),t.bibliography_data&&t.bibliography_data.length>0){const e=common.create_dom_element({element_type:"div",class_name:"info_line separator",parent:o});common.create_dom_element({element_type:"label",class_name:"big_label",text_content:tstring.bibliographic_references||"Bibliographic references",parent:e});const n=common.create_dom_element({element_type:"div",class_name:"info_text_block",parent:o}),a=t.bibliography_data,r=a.length;for(let e=0;e<r;e++){const t=biblio_row_fields.render_row_bibliography(a[e]);common.create_dom_element({element_type:"div",class_name:"bibliographic_reference",parent:n}).appendChild(t)}!function(e,t){e.classList.add("contracted-block");const n=common.create_dom_element({element_type:"div",class_name:"text-block-separator",parent:t}),o=common.create_dom_element({element_type:"div",class_name:"separator-arrow",parent:n});n.addEventListener("click",(function(){e.classList.contains("contracted-block")?(e.classList.remove("contracted-block"),o.style.transform="rotate(-90deg)"):(e.classList.add("contracted-block"),o.style.transform="rotate(90deg)")}))}(n,o)}return t.link&&common.create_dom_element({element_type:"a",class_name:"icon_link info_value",inner_html:t.link,href:t.link,target:"_blank",parent:o}),console.log("row_object:",t),n.appendChild(o),o},draw_map:function(e){const t=this,n=e.map_data,o=n,a=document.getElementById("map_container");t.map=t.map||new map_factory,t.map.init({map_container:a,map_position:o,popup_builder:page.map_popup_builder,popup_options:page.maps_config.popup_options,source_maps:page.maps_config.source_maps});const r=t.map_data(n);return t.map.parse_data_to_map(r,null).then((function(){a.classList.remove("hide_opacity")})),!0},map_data:function(e){const t=this,n=Array.isArray(e)?e:[e],o=[];for(let e=0;e<n.length;e++){const a={lat:n[e].lat,lon:n[e].lon,marker_icon:page.maps_config.markers.hoard,data:{section_id:null,title:t.row.name,description:" "}};o.push(a)}return o}};
//# sourceMappingURL=hoard-min.js.map