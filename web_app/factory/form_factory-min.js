"use strict";function form_factory(){this.form_items=[],this.node=null,this.item_factory=function(e){const t=this.build_form_item(e);return this.build_form_node(t,e.parent),"function"==typeof e.callback&&e.callback(t.node_input),this.form_items[e.id]=t,t},this.build_form_item=function(e){return{id:e.name,name:e.name,label:e.label,class_name:e.class_name||null,q:e.q||"",q_selected:[],q_selected_eq:e.q_selected_eq||"=",q_column:e.q_column,q_splittable:e.q_splittable||!1,eq:"LIKE",eq_in:e.eq_in||"",eq_out:e.eq_out||"%",is_term:e.is_term||!1,callback:e.callback||!1,node_input:null,node_values:null}},this.build_form_node=function(e,t){const n=common.create_dom_element({element_type:"div",class_name:"form-group field",parent:t}),o=common.create_dom_element({element_type:"input",type:"text",id:e.id,class_name:"form-control ui-autocomplete-input"+(e.class_name?" "+e.class_name:""),placeholder:e.label,value:e.q||"",parent:n});o.addEventListener("keyup",(function(t){e.q=t.target.value})),e.node_input=o;const l=common.create_dom_element({element_type:"div",class_name:"container_values",parent:n});return e.node_values=l,!0},this.build_operators_node=function(){const e=common.create_dom_element({element_type:"div",class_name:"form-group field field_operators"}),t=(common.create_dom_element({element_type:"span",class_name:"radio operators",text_content:tstring.operator||"Operator",parent:e}),common.create_dom_element({element_type:"input",type:"radio",id:"operator_or",parent:e}));t.setAttribute("name","operators"),t.setAttribute("value","OR");common.create_dom_element({element_type:"label",text_content:tstring.or||"or",parent:e}).setAttribute("for","operator_or");const n=common.create_dom_element({element_type:"input",type:"radio",id:"operator_and",name:"operators",parent:e});n.setAttribute("name","operators"),n.setAttribute("value","AND"),n.setAttribute("checked","checked");return common.create_dom_element({element_type:"label",text_content:tstring.and||"and",parent:e}).setAttribute("for","operator_and"),e},this.add_selected_value=function(e,t,n){const o=e.node_values,l=o.querySelectorAll(".input_values");for(let e=l.length-1;e>=0;e--)if(n===l[e].value)return!1;const a=common.create_dom_element({element_type:"div",class_name:"line_value",parent:o});common.create_dom_element({element_type:"i",class_name:"icon remove fal far fa-trash-alt",parent:a}).addEventListener("click",(function(){const t=e.q_selected.indexOf(n);t>-1&&(e.q_selected.splice(t,1),this.parentNode.remove(),!0===SHOW_DEBUG&&console.log("form_item.q_selected removed value:",n,e.q_selected))}));common.create_dom_element({element_type:"span",class_name:"value_label",text_content:t,parent:a});return common.create_dom_element({element_type:"input",class_name:"input_values",parent:a}).value=n,e.q_selected.push(n),e.node_input.value="",e.q="",!0},this.build_filter=function(){const e=this.form_items,t=[];for(let[n,o]of Object.entries(e)){const e=!0===o.is_term?"OR":"AND",n={};if(n[e]=[],o.q.length>0){const t="AND",l={};l[t]=[];const a={field:o.q_column,value:`'%${o.q}%'`,op:o.eq};l[t].push(a),n[e].push(l)}if(o.q_selected.length>0)for(let t=0;t<o.q_selected.length;t++){const l=o.q_selected[t],a="AND",r={};r[a]=[];const _={field:o.q_column,value:"LIKE"===o.q_selected_eq?`'%${l}%'`:`'${l}'`,op:o.q_selected_eq};r[a].push(_),n[e].push(r)}n[e].length>0&&t.push(n)}if(SHOW_DEBUG,t.length<1)return!1;const n=this.node.querySelector('input[name="operators"]:checked'),o={};return o[n?n.value:"AND"]=t,o}}