"use strict";var hoard={section_id:null,export_data_container:null,row_detail_container:null,search_options:{},map:null,table:null,set_up:function(e){const t=this;return t.export_data_container=e.export_data_container,t.row_detail_container=e.row_detail_container,t.section_id=e.section_id,t.table=e.table,t.section_id?t.get_row_data({section_id:e.section_id}).then((function(e){if(console.log("[set_up->get_row_data] ar_rows:",e),e&&e.length>0){t.row=e[0];const n=render_hoard.draw_hoard({row:t.row}),o=t.row_detail_container;for(;o.hasChildNodes();)o.removeChild(o.lastChild);o.appendChild(n),render_hoard.draw_map({map_data:t.row.map,container:document.getElementById("map_container"),self:t});const a=document.getElementById("rows_container");t.get_types_data(t.row,a)}else t.row_detail.innerHTML="Sorry. Empty result for section_id: "+t.section_id})):t.row_detail.innerHTML="Error. Invalid section_id",!0},get_row_data:async function(e){const t=e.section_id,n="section_id="+parseInt(t),o="findspots"===this.table?"findspots":"hoards";return data_manager.request({body:{dedalo_get:"records",db_name:page_globals.WEB_DB,lang:page_globals.WEB_CURRENT_LANG_CODE,table:o,ar_fields:["*"],sql_filter:n,limit:1,count:!1,offset:0,resolve_portals_custom:{coins_data:"coins",bibliography_data:"bibliographic_references"}}}).then((function(e){if(!e.result)return console.warn("Empty result:",e),null;return page.parse_hoard_data(e.result)}))},get_types_data:function(e,t){const n="hoards"===e.table?"numisdata5_"+e.section_id:"numisdata279_"+e.section_id,o=common.create_dom_element({element_type:"div",class_name:"spinner",parent:t}),a={term_id:n},r={coins_list:e.coins,types_list:e.types};return map.load_map_selection_info(a,r).then((function(e){if(o.remove(),e){const n=render_hoard.draw_types_list_node({response:e});t.appendChild(n),setTimeout((function(){const e=t;page.activate_images_gallery(e,!0)}),600)}})),!0}};
//# sourceMappingURL=hoard-min.js.map