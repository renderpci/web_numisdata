"use strict";var coins={form:null,pagination:null,list:null,form_node:null,form_container:null,rows_container:null,set_up:function(n){const e=this;return e.form_container=n.form_container,e.rows_container=n.rows_container,e.form=new form_factory,e.form_node=e.render_form(),e.form_container.appendChild(e.form_node),e.pagination={total:null,limit:10,offset:0,n_nodes:8},event_manager.subscribe("paginate",(function(n){e.pagination.offset=n,e.form_submit()})),!0},render_form:function(){const n=this,e=new DocumentFragment,t=common.create_dom_element({element_type:"div",class_name:"form-row fields",parent:e});n.form.item_factory({id:"section_id",name:"section_id",label:tstring.is||"ID",q_column:"section_id",eq:"=",eq_in:"",eq_out:"",parent:t}),n.form.item_factory({id:"collection",name:"collection",label:tstring.collection||"collection",q_column:"collection",eq:"LIKE",eq_in:"%",eq_out:"%",parent:t,callback:function(e){n.form.activate_autocomplete({form_item:e,table:"coins"})}}),n.form.item_factory({id:"public_info",name:"public_info",label:tstring.public_info||"public_info",q_column:"public_info",eq:"LIKE",eq_in:"%",eq_out:"%",parent:t,callback:function(e){n.form.activate_autocomplete({form_item:e,table:"coins"})}}),n.form.item_factory({id:"mint",name:"mint",label:tstring.mint||"mint",q_column:"mint",eq:"LIKE",eq_in:"%",eq_out:"%",parent:t,callback:function(e){n.form.activate_autocomplete({form_item:e,table:"coins"})}});const o=common.create_dom_element({element_type:"div",class_name:"form-group field button_submit",parent:e});common.create_dom_element({element_type:"input",type:"submit",id:"submit",value:tstring.search||"Search",class_name:"btn btn-light btn-block primary",parent:o}).addEventListener("click",(function(e){e.preventDefault(),n.form_submit()}));const i=n.form.build_operators_node();e.appendChild(i);const r=common.create_dom_element({element_type:"form",id:"search_form",class_name:"form-inline"});return r.appendChild(e),r},form_submit:function(){const n=this,e=n.form_node;if(!e)return new Promise((function(n){console.error("Error on submit. Invalid form_node.",e),n(!1)}));const t=n.rows_container;return n.pagination.total?t.classList.add("loading"):page.add_spinner(t),new Promise((function(o){const i=n.pagination.limit,r=n.pagination.offset,a=n.form.form_to_sql_filter({form_node:e});data_manager.request({body:{dedalo_get:"records",table:"coins",ar_fields:["*"],sql_filter:a,limit:i,count:!0,offset:r,order:"section_id ASC",process_result:null}}).then((function(e){console.log("--------------- api_response:",e);const i=page.parse_coin_data(e.result),a=e.total;n.pagination.total=a,n.pagination.offset=r,i||(t.classList.remove("loading"),o(null)),function(){for(;t.hasChildNodes();)t.removeChild(t.lastChild);t.classList.remove("loading")}(),n.list=n.list||new list_factory,n.list.init({data:i,fn_row_builder:n.list_row_builder,pagination:n.pagination,caller:n}),n.list.render_list().then((function(n){n&&t.appendChild(n),o(n)}))}))}))},list_row_builder:function(n,e){return coins_row_fields.draw_item(n)}};